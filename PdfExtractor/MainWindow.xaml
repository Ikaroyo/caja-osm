<Window x:Class="PdfExtractor.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:wf="clr-namespace:System.Windows.Forms;assembly=System.Windows.Forms"
        xmlns:wv2="clr-namespace:Microsoft.Web.WebView2.Wpf;assembly=Microsoft.Web.WebView2.Wpf"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        Title="PDF Extractor - Control de Caja OSM" Height="900" Width="1400" WindowState="Maximized">
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="650" MinWidth="400"/>
            <ColumnDefinition Width="5"/>
            <ColumnDefinition Width="*" MinWidth="300"/>
        </Grid.ColumnDefinitions>
        
        <!-- Left Panel: Web Browser -->
        <Border Grid.Column="0" BorderBrush="Gray" BorderThickness="1" Margin="5">
            <Grid>
                <!-- WebBrowser cl√°sico para Java applets -->
                <WindowsFormsHost Margin="5" Height="850">
                    <wf:WebBrowser x:Name="WebBrowser" 
                                   ScriptErrorsSuppressed="False"
                                   WebBrowserShortcutsEnabled="True"
                                   IsWebBrowserContextMenuEnabled="True"
                                   AllowWebBrowserDrop="True"
                                   DocumentCompleted="WebBrowser_DocumentCompleted"
                                   Navigating="WebBrowser_Navigating"/>
                </WindowsFormsHost>
            </Grid>
        </Border>

        <!-- Resizable Splitter -->
        <GridSplitter Grid.Column="1" 
                      HorizontalAlignment="Stretch" 
                      VerticalAlignment="Stretch"
                      Background="LightGray"
                      ShowsPreview="True"
                      ResizeBehavior="PreviousAndNext"
                      Width="5"/>

        <!-- Right Panel: Tabs -->
        <Border Grid.Column="2" BorderBrush="DarkGray" BorderThickness="2" Margin="10">
            <TabControl x:Name="mainTabControl" Background="WhiteSmoke">
                
                <!-- PDF Extractor Tab -->
                <TabItem Header="üìÑ Extractor PDF" FontWeight="Bold">
                    <Grid Margin="10">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="200"/>
                        </Grid.RowDefinitions>
                        
                        <!-- PDF Input Section -->
                        <GroupBox Grid.Row="0" Header="Entrada de PDF" Margin="0,0,0,10">
                            <StackPanel Margin="10">
                                <TextBlock Text="Ingrese el link completo o solo el n√∫mero:" FontWeight="Bold" Margin="0,0,0,5"/>
                                <TextBox x:Name="txtInput" Height="25" Margin="0,0,0,10"/>
                                
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                                    <Button x:Name="btnProcess" Content="üì• Procesar PDF" Width="140" Height="30" 
                                           Click="BtnProcess_Click" Margin="0,0,10,0" Background="LightBlue"/>
                                    <Button x:Name="btnClear" Content="üóëÔ∏è Limpiar" Width="80" Height="30" 
                                           Click="BtnClear_Click" Background="LightCoral"/>
                                </StackPanel>
                            </StackPanel>
                        </GroupBox>
                        
                        <!-- Management Buttons -->
                        <GroupBox Grid.Row="1" Header="Gesti√≥n" Margin="0,0,0,10">
                            <StackPanel Orientation="Horizontal" Margin="10" HorizontalAlignment="Left">
                                <Button x:Name="btnViewLotes" Content="üìã Ver Lotes" Width="100" Height="30" 
                                       Click="BtnViewLotes_Click" Margin="0,0,10,0" Background="LightYellow"/>
                            </StackPanel>
                        </GroupBox>
                        
                        <!-- Status -->
                        <TextBlock Grid.Row="2" x:Name="txtStatus" Text="Listo" Margin="0,0,0,10" 
                                  Foreground="Blue" FontWeight="Bold" Background="AliceBlue" Padding="5"/>
                        
                        <!-- Formulario de Extracci√≥n - Oculto en vista principal -->
                        <GroupBox Grid.Row="3" Header="üìã Datos Extra√≠dos" Margin="0,0,0,10" MaxHeight="400" Visibility="Collapsed">
                            <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto">
                                <Grid x:Name="extractedDataPanel" Margin="10">
                                    <!-- Grid content hidden in main view -->
                                </Grid>
                            </ScrollViewer>
                        </GroupBox>
                        
                        <!-- Mensaje informativo en lugar del formulario -->
                        <GroupBox Grid.Row="3" Header="‚ÑπÔ∏è Informaci√≥n" Margin="0,0,0,10">
                            <StackPanel Margin="10">
                                <TextBlock Text="üí° Flujo de trabajo:" FontWeight="Bold" Margin="0,0,0,10"/>
                                <TextBlock TextWrapping="Wrap" Margin="0,0,0,5">
                                    ‚Ä¢ Ingrese el n√∫mero del PDF (ej: 484197) o URL completa
                                </TextBlock>
                                <TextBlock TextWrapping="Wrap" Margin="0,0,0,5">
                                    ‚Ä¢ Presione "Procesar PDF" para descargar y extraer datos
                                </TextBlock>
                                <TextBlock TextWrapping="Wrap" Margin="0,0,0,5">
                                    ‚Ä¢ Se abrir√° una ventana para revisar y confirmar los datos extra√≠dos
                                </TextBlock>
                                <TextBlock TextWrapping="Wrap" Margin="0,0,0,10">
                                    ‚Ä¢ Los datos se guardar√°n autom√°ticamente tras la confirmaci√≥n
                                </TextBlock>
                                <TextBlock Text="üéØ Los datos extra√≠dos aparecer√°n en la ventana de revisi√≥n, no en esta vista principal." 
                                          FontStyle="Italic" Foreground="DarkBlue" TextWrapping="Wrap"/>
                            </StackPanel>
                        </GroupBox>
                        
                        <!-- PDF Content Display - Oculto por solicitud del usuario -->
                        <GroupBox Grid.Row="4" Header="Contenido del PDF" Margin="0,0,0,10" Visibility="Collapsed">
                            <ScrollViewer VerticalScrollBarVisibility="Auto">
                                <TextBox x:Name="txtContent" IsReadOnly="True" TextWrapping="Wrap" 
                                        AcceptsReturn="True" VerticalAlignment="Stretch" 
                                        Background="LightYellow" BorderThickness="0"/>
                            </ScrollViewer>
                        </GroupBox>
                        
                        <!-- Quick Actions -->
                        <GroupBox Grid.Row="5" Header="Acciones R√°pidas">
                            <Grid Margin="5">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                
                                <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                                    <Button Content="üíæ Guardar como..." Width="100" Height="25" Margin="0,0,5,0" Visibility="Collapsed"/>
                                    <Button Content="üìß Enviar por email" Width="120" Height="25" Margin="0,0,5,0" Visibility="Collapsed"/>
                                    <Button Content="üñ®Ô∏è Imprimir" Width="80" Height="25" Click="BtnPrint_Click"/>
                                </StackPanel>
                                
                                <TextBox Grid.Row="1" x:Name="txtQuickNotes" 
                                        TextWrapping="Wrap" AcceptsReturn="True"
                                        Background="LightGray" 
                                        Text="Notas r√°pidas..."/>
                            </Grid>
                        </GroupBox>
                    </Grid>
                </TabItem>
                
                <!-- Arqueo de Caja Tab -->
                <TabItem Header="üí∞ Arqueo de Caja" FontWeight="Bold">
                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <Grid Margin="15">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <!-- Date Selection -->
                            <Grid Grid.Row="0" Margin="0,0,0,20">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="200"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="200"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <TextBlock Grid.Row="0" Grid.Column="0" Text="Fecha Inicial" FontWeight="Bold" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                <DatePicker Grid.Row="0" Grid.Column="1" x:Name="dpFechaInicial" SelectedDate="{x:Static sys:DateTime.Today}" 
                                           Height="30" Margin="0,0,20,0" SelectedDateChanged="DatePicker_SelectedDateChanged"/>
                                
                                <TextBlock Grid.Row="0" Grid.Column="2" Text="Fecha Final" FontWeight="Bold" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                <DatePicker Grid.Row="0" Grid.Column="3" x:Name="dpFechaFinal" SelectedDate="{x:Static sys:DateTime.Today}" 
                                           Height="30" SelectedDateChanged="DatePicker_SelectedDateChanged"/>

                                <!-- Caja Selection and Lote de hoy -->
                                <TextBlock Grid.Row="1" Grid.Column="0" Text="Caja:" FontWeight="Bold" VerticalAlignment="Center" Margin="0,10,10,0"/>
                                <ComboBox Grid.Row="1" Grid.Column="1" x:Name="cmbCajaSelection" Height="30" Margin="0,10,20,0" 
                                         SelectionChanged="CmbCajaSelection_SelectionChanged">
                                    <ComboBoxItem Content="Caja 1" IsSelected="True"/>
                                    <ComboBoxItem Content="Caja 2"/>
                                    <ComboBoxItem Content="Ambas Cajas"/>
                                </ComboBox>
                                
                                <TextBlock Grid.Row="1" Grid.Column="2" Text="Lote de hoy:" FontWeight="Bold" VerticalAlignment="Center" Margin="0,10,10,0"/>
                                <StackPanel Grid.Row="1" Grid.Column="3" Orientation="Horizontal" Margin="0,10,0,0">
                                    <TextBlock Text="$" FontWeight="Bold" VerticalAlignment="Center" Margin="0,0,5,0"/>
                                    <TextBox x:Name="txtLoteHoy" Text="0" Height="30" Width="150" 
                                            TextAlignment="Right" TextChanged="LoteHoy_TextChanged"
                                            ToolTip="Ingresa el monto del lote de hoy (puede usar expresiones como 1000+500)"/>
                                </StackPanel>
                            </Grid>

                            <!-- Total Expected -->
                            <Grid Grid.Row="1" Margin="0,0,0,20">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="200"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                
                                <TextBlock Grid.Column="0" Text="Total Esperado en Caja" FontWeight="Bold" FontSize="14" VerticalAlignment="Center"/>
                                <StackPanel Grid.Column="1" Orientation="Horizontal">
                                    <TextBlock Text="$" FontSize="18" FontWeight="Bold" VerticalAlignment="Center" Margin="0,0,5,0"/>
                                    <TextBox x:Name="txtTotalEsperado" Text="0.00" FontSize="18" FontWeight="Bold" Width="150" 
                                            Height="30" TextAlignment="Right" Background="LightYellow" IsReadOnly="True"/>
                                </StackPanel>
                            </Grid>

                            <!-- Cash Details -->
                            <GroupBox Grid.Row="2" Header="Detalle del Efectivo" FontWeight="Bold" FontSize="14" Margin="0,0,0,20">
                                <StackPanel>
                                    <TextBlock Text="üí° Puedes usar expresiones matem√°ticas en cantidad (ej: 100+5, 20*3, 50-10)" 
                                              FontSize="10" Foreground="Purple" FontStyle="Italic" 
                                              TextAlignment="Center" Margin="5,5,5,10"/>
                                    <Grid Margin="10">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="100"/>
                                        <ColumnDefinition Width="80"/>
                                        <ColumnDefinition Width="100"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="35"/>
                                        <RowDefinition Height="35"/>
                                        <RowDefinition Height="35"/>
                                        <RowDefinition Height="35"/>
                                        <RowDefinition Height="35"/>
                                        <RowDefinition Height="35"/>
                                        <RowDefinition Height="35"/>
                                    </Grid.RowDefinitions>

                                    <!-- Denomination rows -->
                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="$ 20.000" FontWeight="Bold" VerticalAlignment="Center"/>
                                    <TextBox Grid.Row="0" Grid.Column="1" x:Name="txt20000Count" Text="0" TextAlignment="Center" Height="25" 
                                            TextChanged="CashCount_TextChanged"/>
                                    <TextBox Grid.Row="0" Grid.Column="2" x:Name="txt20000Total" Text="$ 0,00" IsReadOnly="True" 
                                            Background="LightGray" Height="25" TextAlignment="Right"/>

                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="$ 10.000" FontWeight="Bold" VerticalAlignment="Center"/>
                                    <TextBox Grid.Row="1" Grid.Column="1" x:Name="txt10000Count" Text="0" TextAlignment="Center" Height="25" 
                                            TextChanged="CashCount_TextChanged"/>
                                    <TextBox Grid.Row="1" Grid.Column="2" x:Name="txt10000Total" Text="$ 0,00" IsReadOnly="True" 
                                            Background="LightGray" Height="25" TextAlignment="Right"/>

                                    <TextBlock Grid.Row="2" Grid.Column="0" Text="$ 2.000" FontWeight="Bold" VerticalAlignment="Center"/>
                                    <TextBox Grid.Row="2" Grid.Column="1" x:Name="txt2000Count" Text="0" TextAlignment="Center" Height="25" 
                                            TextChanged="CashCount_TextChanged"/>
                                    <TextBox Grid.Row="2" Grid.Column="2" x:Name="txt2000Total" Text="$ 0,00" IsReadOnly="True" 
                                            Background="LightGray" Height="25" TextAlignment="Right"/>

                                    <TextBlock Grid.Row="3" Grid.Column="0" Text="$ 1000" FontWeight="Bold" VerticalAlignment="Center"/>
                                    <TextBox Grid.Row="3" Grid.Column="1" x:Name="txt1000Count" Text="0" TextAlignment="Center" Height="25" 
                                            TextChanged="CashCount_TextChanged"/>
                                    <TextBox Grid.Row="3" Grid.Column="2" x:Name="txt1000Total" Text="$ 0,00" IsReadOnly="True" 
                                            Background="LightGray" Height="25" TextAlignment="Right"/>

                                    <TextBlock Grid.Row="4" Grid.Column="0" Text="$ 500" FontWeight="Bold" VerticalAlignment="Center"/>
                                    <TextBox Grid.Row="4" Grid.Column="1" x:Name="txt500Count" Text="0" TextAlignment="Center" Height="25" 
                                            TextChanged="CashCount_TextChanged"/>
                                    <TextBox Grid.Row="4" Grid.Column="2" x:Name="txt500Total" Text="$ 0,00" IsReadOnly="True" 
                                            Background="LightGray" Height="25" TextAlignment="Right"/>

                                    <TextBlock Grid.Row="5" Grid.Column="0" Text="$ 200" FontWeight="Bold" VerticalAlignment="Center"/>
                                    <TextBox Grid.Row="5" Grid.Column="1" x:Name="txt200Count" Text="0" TextAlignment="Center" Height="25" 
                                            TextChanged="CashCount_TextChanged"/>
                                    <TextBox Grid.Row="5" Grid.Column="2" x:Name="txt200Total" Text="$ 0,00" IsReadOnly="True" 
                                            Background="LightGray" Height="25" TextAlignment="Right"/>

                                    <TextBlock Grid.Row="6" Grid.Column="0" Text="$ 100" FontWeight="Bold" VerticalAlignment="Center"/>
                                    <TextBox Grid.Row="6" Grid.Column="1" x:Name="txt100Count" Text="0" TextAlignment="Center" Height="25" 
                                            TextChanged="CashCount_TextChanged"/>
                                    <TextBox Grid.Row="6" Grid.Column="2" x:Name="txt100Total" Text="$ 0,00" IsReadOnly="True" 
                                            Background="LightGray" Height="25" TextAlignment="Right"/>
                                </Grid>
                                </StackPanel>
                            </GroupBox>

                            <!-- Additional Values -->
                            <GroupBox Grid.Row="3" Header="Valores Adicionales" FontWeight="Bold" FontSize="14" Margin="0,0,0,20">
                                <StackPanel>
                                    <TextBlock Text="üí° Tambi√©n puedes usar expresiones matem√°ticas (ej: 1000+500, 300*2, 2000-200)" 
                                              FontSize="10" Foreground="Purple" FontStyle="Italic" 
                                              TextAlignment="Center" Margin="5,5,5,10"/>
                                    <Grid Margin="10">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="100"/>
                                        <ColumnDefinition Width="20"/>
                                        <ColumnDefinition Width="150"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="35"/>
                                        <RowDefinition Height="35"/>
                                        <RowDefinition Height="35"/>
                                        <RowDefinition Height="35"/>
                                        <RowDefinition Height="35"/>
                                    </Grid.RowDefinitions>

                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Valor 1" FontWeight="Bold" VerticalAlignment="Center"/>
                                    <TextBlock Grid.Row="0" Grid.Column="1" Text="$" FontWeight="Bold" VerticalAlignment="Center"/>
                                    <TextBox Grid.Row="0" Grid.Column="2" x:Name="txtValor1" Text="0" Height="25" 
                                            TextAlignment="Right" TextChanged="AdditionalValue_TextChanged"/>

                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="Valor 2" FontWeight="Bold" VerticalAlignment="Center"/>
                                    <TextBlock Grid.Row="1" Grid.Column="1" Text="$" FontWeight="Bold" VerticalAlignment="Center"/>
                                    <TextBox Grid.Row="1" Grid.Column="2" x:Name="txtValor2" Text="0" Height="25" 
                                            TextAlignment="Right" TextChanged="AdditionalValue_TextChanged"/>

                                    <TextBlock Grid.Row="2" Grid.Column="0" Text="Valor 3" FontWeight="Bold" VerticalAlignment="Center"/>
                                    <TextBlock Grid.Row="2" Grid.Column="1" Text="$" FontWeight="Bold" VerticalAlignment="Center"/>
                                    <TextBox Grid.Row="2" Grid.Column="2" x:Name="txtValor3" Text="0" Height="25" 
                                            TextAlignment="Right" TextChanged="AdditionalValue_TextChanged"/>

                                    <TextBlock Grid.Row="3" Grid.Column="0" Text="Valor 4" FontWeight="Bold" VerticalAlignment="Center"/>
                                    <TextBlock Grid.Row="3" Grid.Column="1" Text="$" FontWeight="Bold" VerticalAlignment="Center"/>
                                    <TextBox Grid.Row="3" Grid.Column="2" x:Name="txtValor4" Text="0" Height="25" 
                                            TextAlignment="Right" TextChanged="AdditionalValue_TextChanged"/>

                                    <TextBlock Grid.Row="4" Grid.Column="0" Text="Valor 5" FontWeight="Bold" VerticalAlignment="Center"/>
                                    <TextBlock Grid.Row="4" Grid.Column="1" Text="$" FontWeight="Bold" VerticalAlignment="Center"/>
                                    <TextBox Grid.Row="4" Grid.Column="2" x:Name="txtValor5" Text="0" Height="25" 
                                            TextAlignment="Right" TextChanged="AdditionalValue_TextChanged"/>
                                </Grid>
                                </StackPanel>
                            </GroupBox>

                            <!-- Totals -->
                            <Grid Grid.Row="4" Margin="0,0,0,10">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="200"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="40"/>
                                    <RowDefinition Height="40"/>
                                </Grid.RowDefinitions>

                                <TextBlock Grid.Row="0" Grid.Column="0" Text="Total Contado" FontWeight="Bold" FontSize="16" VerticalAlignment="Center"/>
                                <TextBox Grid.Row="0" Grid.Column="1" x:Name="txtTotalContado" Text="$ 0,00" FontSize="16" FontWeight="Bold" 
                                        Height="30" TextAlignment="Right" IsReadOnly="True" Background="LightBlue"/>

                                <TextBlock Grid.Row="1" Grid.Column="0" Text="Diferencia" FontWeight="Bold" FontSize="16" VerticalAlignment="Center"/>
                                <TextBox Grid.Row="1" Grid.Column="1" x:Name="txtDiferencia" Text="$ 0.00" FontSize="16" FontWeight="Bold" 
                                        Height="30" TextAlignment="Right" IsReadOnly="True" Background="LightCoral"/>
                            </Grid>

                            <!-- Action Buttons -->
                            <StackPanel Grid.Row="5" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,10,0,0">
                                <Button Content="üîÑ Actualizar Total" Background="#3B82F6" Foreground="White" FontWeight="Bold" 
                                       Padding="15,8" Margin="0,0,10,0" Click="BtnActualizarTotal_Click"/>
                                <Button Content="‚Äì" Width="40" Height="40" FontSize="20" FontWeight="Bold" 
                                       Background="LightGray" Margin="0,0,10,0"/>
                                <Button Content="Limpiar Calculadora" Background="#EF4444" Foreground="White" FontWeight="Bold" 
                                       Padding="20,10" Click="BtnLimpiarCalculadora_Click"/>
                            </StackPanel>
                        </Grid>
                    </ScrollViewer>
                </TabItem>
                
                <!-- Cuentas Varias Tab -->
                <TabItem Header="üßÆ Cuentas Varias" FontWeight="Bold">
                    <Grid Margin="15">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- Calculator Header -->
                        <GroupBox Grid.Row="0" Header="Calculadora de Cuentas Varias" FontWeight="Bold" FontSize="14" Margin="0,0,0,20">
                            <TextBlock Margin="10" Text="Utiliza esta calculadora para operaciones contables diversas" 
                                      FontStyle="Italic" Foreground="Gray"/>
                        </GroupBox>

                        <!-- Calculator Display -->
                        <Grid Grid.Row="1">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <!-- Display -->
                            <GroupBox Grid.Row="0" Header="Pantalla" Margin="0,0,0,20">
                                <StackPanel Margin="10">
                                    <TextBox x:Name="txtCalculatorDisplay" Text="0" FontSize="24" FontWeight="Bold" 
                                            Height="50" TextAlignment="Right" IsReadOnly="False" 
                                            Background="Black" Foreground="Lime" FontFamily="Consolas" 
                                            KeyDown="TxtCalculatorDisplay_KeyDown" TextChanged="TxtCalculatorDisplay_TextChanged"/>
                                    <TextBlock Text="Escribe expresiones como: 30*500-500, 100+200*3, etc. Presiona Enter para calcular" 
                                              FontSize="10" Foreground="Gray" TextAlignment="Center" Margin="0,5,0,0"/>
                                </StackPanel>
                            </GroupBox>

                            <!-- Buttons -->
                            <GroupBox Grid.Row="1" Header="Operaciones">
                                <Grid Margin="10">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="50"/>
                                        <RowDefinition Height="50"/>
                                        <RowDefinition Height="50"/>
                                        <RowDefinition Height="50"/>
                                        <RowDefinition Height="50"/>
                                        <RowDefinition Height="50"/>
                                    </Grid.RowDefinitions>

                                    <!-- Row 0 -->
                                    <Button Grid.Row="0" Grid.Column="0" Content="C" Click="BtnCalc_Click" Margin="2" Background="Red" Foreground="White" FontWeight="Bold"/>
                                    <Button Grid.Row="0" Grid.Column="1" Content="¬±" Click="BtnCalc_Click" Margin="2" Background="Orange" Foreground="White"/>
                                    <Button Grid.Row="0" Grid.Column="2" Content="%" Click="BtnCalc_Click" Margin="2" Background="Orange" Foreground="White"/>
                                    <Button Grid.Row="0" Grid.Column="3" Content="√∑" Click="BtnCalc_Click" Margin="2" Background="DarkBlue" Foreground="White" FontWeight="Bold"/>

                                    <!-- Row 1 -->
                                    <Button Grid.Row="1" Grid.Column="0" Content="7" Click="BtnCalc_Click" Margin="2" Background="Gray" Foreground="White" FontWeight="Bold"/>
                                    <Button Grid.Row="1" Grid.Column="1" Content="8" Click="BtnCalc_Click" Margin="2" Background="Gray" Foreground="White" FontWeight="Bold"/>
                                    <Button Grid.Row="1" Grid.Column="2" Content="9" Click="BtnCalc_Click" Margin="2" Background="Gray" Foreground="White" FontWeight="Bold"/>
                                    <Button Grid.Row="1" Grid.Column="3" Content="√ó" Click="BtnCalc_Click" Margin="2" Background="DarkBlue" Foreground="White" FontWeight="Bold"/>

                                    <!-- Row 2 -->
                                    <Button Grid.Row="2" Grid.Column="0" Content="4" Click="BtnCalc_Click" Margin="2" Background="Gray" Foreground="White" FontWeight="Bold"/>
                                    <Button Grid.Row="2" Grid.Column="1" Content="5" Click="BtnCalc_Click" Margin="2" Background="Gray" Foreground="White" FontWeight="Bold"/>
                                    <Button Grid.Row="2" Grid.Column="2" Content="6" Click="BtnCalc_Click" Margin="2" Background="Gray" Foreground="White" FontWeight="Bold"/>
                                    <Button Grid.Row="2" Grid.Column="3" Content="-" Click="BtnCalc_Click" Margin="2" Background="DarkBlue" Foreground="White" FontWeight="Bold"/>

                                    <!-- Row 3 -->
                                    <Button Grid.Row="3" Grid.Column="0" Content="1" Click="BtnCalc_Click" Margin="2" Background="Gray" Foreground="White" FontWeight="Bold"/>
                                    <Button Grid.Row="3" Grid.Column="1" Content="2" Click="BtnCalc_Click" Margin="2" Background="Gray" Foreground="White" FontWeight="Bold"/>
                                    <Button Grid.Row="3" Grid.Column="2" Content="3" Click="BtnCalc_Click" Margin="2" Background="Gray" Foreground="White" FontWeight="Bold"/>
                                    <Button Grid.Row="3" Grid.Column="3" Content="+" Click="BtnCalc_Click" Margin="2" Background="DarkBlue" Foreground="White" FontWeight="Bold"/>

                                    <!-- Row 4 -->
                                    <Button Grid.Row="4" Grid.Column="0" Grid.ColumnSpan="2" Content="0" Click="BtnCalc_Click" Margin="2" Background="Gray" Foreground="White" FontWeight="Bold"/>
                                    <Button Grid.Row="4" Grid.Column="2" Content="," Click="BtnCalc_Click" Margin="2" Background="Gray" Foreground="White" FontWeight="Bold"/>
                                    <Button Grid.Row="4" Grid.Column="3" Content="=" Click="BtnCalc_Click" Margin="2" Background="Green" Foreground="White" FontWeight="Bold"/>

                                    <!-- Row 5 - Eval Button -->
                                    <Button Grid.Row="5" Grid.Column="0" Grid.ColumnSpan="4" Content="üìù EVALUAR EXPRESI√ìN" Click="BtnEvaluateExpression_Click" 
                                           Margin="2" Background="Purple" Foreground="White" FontWeight="Bold"/>
                                </Grid>
                            </GroupBox>
                        </Grid>

                        <!-- Calculator Info -->
                        <GroupBox Grid.Row="2" Header="Informaci√≥n">
                            <StackPanel Margin="10">
                                <TextBlock Text="‚Ä¢ Utiliza la coma (,) como separador decimal" FontSize="12" Margin="0,2"/>
                                <TextBlock Text="‚Ä¢ Presiona C para limpiar" FontSize="12" Margin="0,2"/>
                                <TextBlock Text="‚Ä¢ Operaciones: +, -, √ó, √∑, %" FontSize="12" Margin="0,2"/>
                                <TextBlock Text="‚Ä¢ Escribe expresiones: 30*500-500, 100+200*3" FontSize="12" Margin="0,2" FontWeight="Bold" Foreground="Purple"/>
                                <TextBlock Text="‚Ä¢ Presiona Enter o bot√≥n EVALUAR para calcular" FontSize="12" Margin="0,2" FontWeight="Bold" Foreground="Purple"/>
                            </StackPanel>
                        </GroupBox>
                    </Grid>
                </TabItem>
                
                <!-- Additional Tools Tab -->
                <TabItem Header="‚öôÔ∏è Configuraciones" FontWeight="Bold">
                    <Grid Margin="10">
                        <StackPanel>
                            <GroupBox Header="Configuraci√≥n de Guardado" Margin="0,0,0,20">
                                <StackPanel Margin="10">
                                    <Button x:Name="btnConfig" Content="üíæ Configurar Ubicaci√≥n de Lotes" Height="35" Margin="0,0,0,10" 
                                           Click="BtnConfig_Click" HorizontalAlignment="Stretch" Background="LightBlue"/>
                                    <TextBlock Text="Configura d√≥nde se guardan los datos de los lotes procesados" 
                                              FontStyle="Italic" Foreground="Gray" Margin="0,0,0,10"/>
                                </StackPanel>
                            </GroupBox>
                            
                            <GroupBox Header="Herramientas de Sistema" Margin="0,0,0,20">
                                <StackPanel Margin="10">
                                    <Button Content="üîç Verificar Java" Height="35" Margin="0,0,0,10" 
                                           Click="BtnCheckJava_Click" HorizontalAlignment="Stretch"/>
                                    <Button Content="üìÅ Abrir Carpeta de Datos" Height="35" Margin="0,0,0,10" 
                                           Click="BtnOpenDataFolder_Click" HorizontalAlignment="Stretch"/>
                                    <Button Content="üîÑ Reiniciar Aplicaci√≥n" Height="35" 
                                           Click="BtnRestartApp_Click" HorizontalAlignment="Stretch"/>
                                </StackPanel>
                            </GroupBox>
                            
                            <GroupBox Header="Informaci√≥n del Sistema">
                                <TextBox x:Name="txtSystemInfo" IsReadOnly="True" Height="200" 
                                        TextWrapping="Wrap" AcceptsReturn="True" 
                                        VerticalScrollBarVisibility="Auto" Background="LightGray"/>
                            </GroupBox>
                        </StackPanel>
                    </Grid>
                </TabItem>
                
                <!-- Debug Tab -->
                <TabItem Header="üêõ Debug" FontWeight="Bold" Background="Orange" Visibility="Collapsed">
                    <Grid Margin="10">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        
                        <GroupBox Grid.Row="0" Header="Controles de Debug" Margin="0,0,0,10">
                            <StackPanel Margin="10">
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                    <Button x:Name="btnClearDebug" Content="üóëÔ∏è Limpiar" Width="80" Height="30" 
                                           Click="BtnClearDebug_Click" Margin="0,0,10,0" Background="Red" Foreground="White"/>
                                    <Button x:Name="btnTestNav" Content="üîÑ Test Nav" Width="80" Height="30" 
                                           Click="BtnTestNav_Click" Margin="0,0,10,0" Background="Blue" Foreground="White"/>
                                    <Button x:Name="btnCheckBrowser" Content="üîç Check" Width="80" Height="30" 
                                           Click="BtnCheckBrowser_Click" Margin="0,0,10,0" Background="Green" Foreground="White"/>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal">
                                    <Button x:Name="btnForceJava" Content="‚òï Force Java" Width="80" Height="30" 
                                           Click="BtnForceJava_Click" Margin="0,0,5,0" Background="Orange" Foreground="White"/>
                                    <Button x:Name="btnCheckJavaStatus" Content="‚úÖ Status" Width="60" Height="30" 
                                           Click="BtnCheckJavaStatus_Click" Margin="0,0,5,0" Background="Purple" Foreground="White"/>
                                    <Button x:Name="btnFixPermissions" Content="üîß Fix Perms" Width="80" Height="30" 
                                           Click="BtnFixPermissions_Click" Margin="0,0,5,0" Background="Red" Foreground="White"/>
                                    <Button x:Name="btnLaunchJNLP" Content="üöÄ JNLP" Width="60" Height="30" 
                                           Click="BtnLaunchJNLP_Click" Margin="0,0,5,0" Background="DarkBlue" Foreground="White"/>
                                    <Button x:Name="btnSigemiAuto" Content="üéØ SIGEMI" Width="70" Height="30" 
                                           Click="BtnSigemiAuto_Click" Background="MediumSeaGreen" Foreground="White" FontWeight="Bold"/>
                                </StackPanel>
                            </StackPanel>
                        </GroupBox>
                        
                        <GroupBox Grid.Row="1" Header="Log de Debug en Tiempo Real">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                
                                <Border Grid.Row="0" Background="LightYellow" Padding="10" Margin="0,0,0,5">
                                    <TextBlock TextWrapping="Wrap" FontSize="11">
                                        <Run FontWeight="Bold" Foreground="DarkRed">üéØ PROBLEMA IDENTIFICADO:</Run>
                                        <LineBreak/>
                                        <Run>Oracle Forms requiere Java 1.4.2 (2003) pero tienes Java 1.8. El WebBrowser .NET no puede ejecutar applets Java por incompatibilidad de versiones.</Run>
                                        <LineBreak/>
                                        <Run FontWeight="Bold" Foreground="DarkBlue">‚úÖ SOLUCI√ìN RECOMENDADA:</Run>
                                        <Run>Usar </Run><Run FontWeight="Bold">"üöÄ JNLP"</Run><Run> o navegador externo que puede manejar versiones Java m√∫ltiples.</Run>
                                    </TextBlock>
                                </Border>
                                
                                <ScrollViewer Grid.Row="1" x:Name="DebugScrollViewer" VerticalScrollBarVisibility="Auto">
                                    <TextBox x:Name="txtDebugLog" IsReadOnly="True" 
                                            Background="Black" Foreground="Lime" 
                                            FontFamily="Consolas" FontSize="11"
                                            TextWrapping="Wrap" AcceptsReturn="True"
                                            Text="=== LOG DE DEBUG ===&#x0A;Esperando eventos...&#x0A;"/>
                                </ScrollViewer>
                            </Grid>
                        </GroupBox>
                    </Grid>
                </TabItem>
            </TabControl>
        </Border>
    </Grid>
</Window>
